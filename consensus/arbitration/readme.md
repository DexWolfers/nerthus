
# 见证人作恶管理

当发现见证人作恶时，为了快速在通知到全网节点。需要在发现作恶时，立即将作恶证据广播。


证据需要保存在本地，以便留存。保留的证据，不考虑哪个是合法单元，只需要保留作恶信息。
最终是被系统见证人决定如何处理。

## 发现作恶

当发现作恶时激活如下操作：

1. 根据本节点视角，选择出一个合法单元
2. 将非法单元数据全部删除
3. 保留作恶证据
    + badChain_%chain% = {%number%,%proof_id%}
    + badWitnessProof_%id%=%info%
4. 广播作恶证据到网络   
5. 停止和此链相关联的见证服务，并记录有哪些链受影响
   + 遍历查找所有关联链的起始单元（unit.chain, unit.number）
   + 标记受影响链：stopedChain_%chain% = %number%
   
6. 系统见证人选择和合法单元进行仲裁 


## 单元存储校验增加检查

1. 链已停止，符合条件的单元则不允许存储相关单元：
   + Number(stopedChain_%chain%) < NewUnitNumber 
   

## 链仲裁

系统见证必须百分比完成仲裁，否则将导致链停摆。

1. 定期检查是否有需要仲裁链，
    badChain_%*% ---> get chain and number
 
2. 选择一个合法单元，并创建交易
   badChain_Tx_%chain% = %Tx%

3. 如果存在交易，但是尚未仲裁成功，需要继续发送
   +. 检查是否存在仲裁交易： badChain_Tx_%chain%
   +. 查找交易是否完成： TxStatus
   +. 继续在见证人网络中广播此交易   
  